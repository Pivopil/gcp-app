timeout: 1200s
steps:
  # terraform init -input=false
  - name: gcr.io/$PROJECT_ID/terraform
    args:
      - init
      - -input=false
  # terraform validate
  - name: gcr.io/$PROJECT_ID/terraform
    args:
      - validate
  # terraform plan -input=false -out=tfplan
  - name: gcr.io/$PROJECT_ID/terraform
    args:
      - plan
      - -input=false
      - -out=tfplan
artifacts:
  objects:
    location: 'gs://${_ARTIFACT_BUCKET_NAME}/terraform/cloudbuild/plan/$BUILD_ID'
    paths: ['lint.cloudbuild.yaml', 'tfplan']
